{
    "name": "Sufficient Specification - Data Specification v3",
    "description": "Re-design prompt bases on best performing prompt that combined the specification dimensions; add focus on clarifying questions that indicate different types of underspecification.",
    "results": [],
    "observations": "/data/development/sufficient_specification/development_results/dev_results_09_data_10_procedural.parquet",
    "prompt_template": {
        "messages": [
            {
                "role": "system",
                "content": "\nYou are an **expert data analyst and annotator**. Your purpose is to meticulously analyze a user query to determine if it is **sufficiently specified** to be answerable in an open-domain insight extraction setting.\n\nAn \"open-domain\" system must identify relevant data from a massive, unknown corpus of tables before executing a query. For this to be possible, the query must be **self-contained and unambiguous**, providing enough detail to pinpoint the correct data without needing to ask for clarification.\n\n### Core Principle:\nBefore you begin, apply this mental model: Imagine you must give the query to a researcher who has access to every table in the world but **cannot ask you any clarifying questions**. Your task is to decide if they could find the **a relevant set of tables** to work on. If they would have to ask clarifying questions like \"which employees?\" or \"for what year?\", the query's data specification is flawed.\n\n### Data Specification Dimensions:\n\nYou will analyze the query based on the following three dimensions of data specification.\n\n\n#### 1. Entity Specification (Binary: `Specified` / `Underspecified`) (Clarifying questions are typically: \"What...?\", \"Which...?\", \"Whose...?\", \"Who...?\")\n\nThis dimension evaluates the **core subjects (nouns)** of the query based on the Principle of Reasonable Resolvability: an entity is specified if a capable system can be expected to find and disambiguate it with high confidence using the query's context and world knowledge.\n\n* **Specified**: The entities in the query are specific enough to be confidently identified. There is two main ways this can be true:\n    1. Unique identification: The query refers to one or more specific entities that are uniquely named or can be confidently resolved to a single instance (e.g., \"the 2024 Tour de France,\" \"GDP of Brazil,\" \"Ronaldo\" (in the context of football)). This includes entities that require multi-step lookups or contextual disambiguation (e.g., \"the actor who played the main character in the 2005 film 'The Great Film'\" is specified if that film is unique).\n    2. Broad classes: The query refers to a well-defined class of entities, where the user's intent is to query over the entire class. This also includes concepts where finding a suitable dataset is part of the challenge.\n* **Underspecified**: The query refers to an entity that is truly ambiguous even with world knowledge, where multiple plausible candidates exist and the query provides no path to resolution (e.g., \"the recent race,\" \"the company's revenue\").\n\n#### 2. Temporal Specification (Quaternary: `Specified` / `Underspecified (Assuming Recency)` / `Underspecified (Ambiguous)` / `Not Applicable`) (Clarifying questions are typically: \"When...?\", \"For what time period...?\", \"As of when...?\")\n\nThis dimension evaluates the **time frame** used to filter the data.\n\n* **`Specified`**: The query provides a clear time frame, which can be an explicit range (\"in 2023\"), a resolvable term (\"last year\"), or an implicit **\"all-time\" scope** assumed for superlative/cumulative queries (\"Who has won the most Oscars?\").\n* **`Underspecified (Assuming Recency)`**: The query lacks a time frame, but the most probable intent is the most recent available data.\n    * This should be considered the standard default for general statistical queries about current states, such as populations, demographics, economic indicators, or inventory counts (e.g., a query about \"the number of hospitals\" or \"the unemployment rate\").\n    * Use this for queries about data that is periodically updated or versioned, where the most common-sense intent is to use the latest available data (e.g., population statistics, economic indicators, inventory counts).\nThe query lacks a time frame, but the most probable intent is the **most recent available data** (\"What is the population of India?\"). Use this for queries about data that is periodically updated or versioned, where the most common-sense intent is to use the latest available data (e.g., population statistics).\n* **`Underspecified (Ambiguous)`**: The query lacks a time frame, and the intent is truly ambiguous with no safe default (\"What was the stock price of Apple?\").\n* **`Not Applicable`**: The query concerns a stable, definitional fact that is not expected to change, such as historical events, physical constants, or mathematical definitions (e.g., \"When was the Eiffel Tower completed?\"). Do not use this for data that is versioned or updated, even if infrequently.\n\n#### 3. Domain Specification (Quaternary: `Specified` / `Underspecified (Assuming Universal Domain)` / `Underspecified (Ambiguous)` / `Not Applicable`) (Clarifying questions are typically: \"Where...?\", \"In what context...?\", \"For which group...?\", \"For whom...?\")\n\nThis dimension evaluates the **contextual boundary** (geographical, organizational, conceptual) used to filter the data.\n\n* **`Specified`**: The query defines a boundary that is globally unique or self-contained in its common-sense context.\n    * This includes globally unique entities (e.g., \"companies **in Japan**,\" \"clubs in the **English Premier League**\").\n    * This also includes entities with a single, overwhelmingly dominant interpretation (e.g., a query about \"the Bay Area\" clearly implies the San Francisco Bay Area).\n* **`Underspecified (Assuming Universal Domain)`**: The query lacks a boundary, but has a sensible, widest-possible default interpretation (e.g., \"highest mountain\" -> world, \"largest economy\" -> global).\n* **`Underspecified (Ambiguous)`**: The query lacks a boundary, and the context is truly missing (\"highest-paid employees,\" which requires a company). Only use this category if the query is nonsensical without a specific domain.\n* **`Not Applicable`**: The query's concept has no inherent domain boundary (\"What is the element with the atomic number of 1?\").\n"
            },
            {
                "role": "user",
                "content": "Query: {query}"
            }
        ]
    },
    "common_request": {
        "model": "gpt-5-2025-08-07",
        "tools": null,
        "top_p": null,
        "parallel_tool_calls": null,
        "prompt_cache_key": "sufficient_data_specification_v3",
        "safety_identifier": null,
        "service_tier": null,
        "store": null,
        "temperature": null,
        "tool_choice": null,
        "top_logprobs": null,
        "conversation": null,
        "include": null,
        "input": null,
        "instructions": null,
        "max_output_tokens": null,
        "max_tool_calls": null,
        "previous_response_id": null,
        "prompt": null,
        "reasoning": null,
        "text": {
            "format": {
                "type": "json_schema",
                "name": "DataSpecification",
                "schema": {
                    "$defs": {
                        "DomainSpecification": {
                            "properties": {
                                "analysis": {
                                    "description": "A brief analysis of the domain specification.",
                                    "title": "Analysis",
                                    "type": "string"
                                },
                                "classification": {
                                    "description": "Classification of the query's domain/contextual boundary (geographical, organizational, etc.).",
                                    "enum": [
                                        "Specified",
                                        "Underspecified (Assuming Universal Domain)",
                                        "Underspecified (Ambiguous)",
                                        "Not Applicable"
                                    ],
                                    "title": "Classification",
                                    "type": "string"
                                }
                            },
                            "required": [
                                "analysis",
                                "classification"
                            ],
                            "title": "DomainSpecification",
                            "type": "object",
                            "additionalProperties": false
                        },
                        "EntitySpecification": {
                            "properties": {
                                "analysis": {
                                    "description": "A brief analysis of the entity specification.",
                                    "title": "Analysis",
                                    "type": "string"
                                },
                                "classification": {
                                    "description": "Classification of the query's core subjects (nouns).",
                                    "enum": [
                                        "Specified",
                                        "Underspecified"
                                    ],
                                    "title": "Classification",
                                    "type": "string"
                                }
                            },
                            "required": [
                                "analysis",
                                "classification"
                            ],
                            "title": "EntitySpecification",
                            "type": "object",
                            "additionalProperties": false
                        },
                        "TemporalSpecification": {
                            "properties": {
                                "analysis": {
                                    "description": "A brief analysis of the temporal specification.",
                                    "title": "Analysis",
                                    "type": "string"
                                },
                                "classification": {
                                    "description": "Classification of the query's temporal specification.",
                                    "enum": [
                                        "Specified",
                                        "Underspecified (Assuming Recency)",
                                        "Underspecified (Ambiguous)",
                                        "Not Applicable"
                                    ],
                                    "title": "Classification",
                                    "type": "string"
                                }
                            },
                            "required": [
                                "analysis",
                                "classification"
                            ],
                            "title": "TemporalSpecification",
                            "type": "object",
                            "additionalProperties": false
                        }
                    },
                    "properties": {
                        "entity_specification": {
                            "$ref": "#/$defs/EntitySpecification"
                        },
                        "temporal_specification": {
                            "$ref": "#/$defs/TemporalSpecification"
                        },
                        "domain_specification": {
                            "$ref": "#/$defs/DomainSpecification"
                        }
                    },
                    "required": [
                        "entity_specification",
                        "temporal_specification",
                        "domain_specification"
                    ],
                    "title": "DataSpecification",
                    "type": "object",
                    "additionalProperties": false
                },
                "strict": true
            }
        },
        "truncation": null
    }
}