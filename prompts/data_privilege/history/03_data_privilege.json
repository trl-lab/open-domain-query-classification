{
    "name": "Schema Dependence - Fine-grained v2",
    "description": "Making the sub-dimensions more concrete and introducing an extended response schema.",
    "results": [],
    "observations": "Small improvement over inital fine-grained prompt.",
    "prompt_template": {
        "messages": [
            {
                "role": "system",
                "content": "\nYou are an expert data analyst specializing in human-computer interaction and natural language interfaces for databases. Your task is to analyze a user query and determine if it is schema-dependent.\n\nA query is schema-dependent if its phrasing suggests the user has prior knowledge of the underlying data's specific structure or content. In a true open-domain setting, a user would ask a natural, conceptual question about the world, not a question crafted around specific datasets they have already seen. A schema-independent query, in contrast, is a natural, conceptual question about the world. Analytical complexity is NOT a sign of schema-dependence. A complex question with many conditions can still be perfectly schema-independent.\n\nYou will classify each query along three dimensions of schema-dependence. For each query, provide your step-by-step reasoning in the analysis field and then set the flags for each dimension according to the definitions below.\n\nClassification Dimensions\n\n- Structural Reference (structure_reference: bool):\n    - Set to true if: The query uses terminology that is unnaturally specific or technical, strongly suggesting it was copied or adapted from a table's column or header names. It includes any language that a typical user, unaware of the schema, would not use.\n    - Reinforcing Signals: Look for code-like syntax (snake_case, camelCase) or formatting like backticks (e.g., `bikes id`).\n    - Example of subtle reference: A query asking for the \"event message type\" instead of \"what kind of event happened?\".\n    - Example of explicit reference: A query asking for the mean of the \"EVENTTIME\" column.\n\n- Value Reference (value_reference: Literal[\"True\", \"Obscure\", \"False\"]):\n    - Set to \"True\" (Strong Signal) if: The query contains a clear, unambiguous value reference. This includes:\n        - Internal Identifiers: Non-public codes, serial numbers, or IDs (e.g., \"order TXN-9B4C-2A8E\").\n        - Formatted Values: The use of non-standard formatting like single or double quotes around a value, which implies a literal string lookup (e.g., \"competing in the sport 'Tennis'\").\n    - Set to \"Obscure\" (Weak Signal) if: The query uses a highly specific but publicly knowable fact (e.g., exact results of a sporting event, an exact birthdate). These are values a user could know from an external source, but they are not internal IDs.\n    - Set to \"False\" if: The query contains no specific value references or only uses common, public knowledge entities (e.g., \"France\", \"Taylor Swift\").\n\n- Container Reference (container_reference: bool):\n    - Set to true if: The query explicitly refers to the data artifact itself. This breaks the illusion of a natural open-domain interaction by turning it into a direct instruction about a file.\n    - Keywords to look for: \"dataset\", \"table\", \"file\", \"data\", \"spreadsheet\", etc.\n    - Example: \"Using the provided dataset, find the top five most frequent qualifications.\"\n"
            },
            {
                "role": "user",
                "content": "Query: {query}"
            }
        ]
    },
    "common_request": {
        "model": "gpt-5-mini-2025-08-07",
        "tools": null,
        "top_p": null,
        "parallel_tool_calls": null,
        "prompt_cache_key": "schema_dependence_v3",
        "safety_identifier": null,
        "service_tier": null,
        "store": null,
        "temperature": null,
        "tool_choice": null,
        "top_logprobs": null,
        "conversation": null,
        "include": null,
        "input": null,
        "instructions": null,
        "max_output_tokens": null,
        "max_tool_calls": null,
        "previous_response_id": null,
        "prompt": null,
        "reasoning": null,
        "text": {
            "format": {
                "type": "json_schema",
                "name": "SchemaDependence",
                "schema": {
                    "properties": {
                        "structural_reference_analysis": {
                            "title": "Structural Reference Analysis",
                            "type": "string"
                        },
                        "structural_reference": {
                            "title": "Structural Reference",
                            "type": "boolean"
                        },
                        "value_reference_analysis": {
                            "title": "Value Reference Analysis",
                            "type": "string"
                        },
                        "value_reference": {
                            "enum": [
                                "True",
                                "Obscure",
                                "False"
                            ],
                            "title": "Value Reference",
                            "type": "string"
                        },
                        "container_reference_analysis": {
                            "title": "Container Reference Analysis",
                            "type": "string"
                        },
                        "container_reference": {
                            "title": "Container Reference",
                            "type": "boolean"
                        }
                    },
                    "required": [
                        "structural_reference_analysis",
                        "structural_reference",
                        "value_reference_analysis",
                        "value_reference",
                        "container_reference_analysis",
                        "container_reference"
                    ],
                    "title": "SchemaDependence",
                    "type": "object",
                    "additionalProperties": false
                },
                "strict": true
            }
        },
        "truncation": null
    }
}